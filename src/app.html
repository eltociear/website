<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="GGF">

    <meta name="theme-color" content="#2B4B8C">

    <meta charset="utf-8" />
    <link rel="icon" href="%sveltekit.assets%/icons/favicon.png" type="image/png">
    <link rel="icon" href="%sveltekit.assets%/icons/favicon.ico" sizes="any">
    <link rel="apple-touch-icon" href="%sveltekit.assets%/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="152x152" href="%sveltekit.assets%/icons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="%sveltekit.assets%/icons/apple-touch-icon-167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="%sveltekit.assets%/icons/apple-touch-icon-180.png">
    <link rel="mask-icon" href="%sveltekit.assets%/icons/maskable_icon192.png" color="#2B4B8C">
    <meta name="msapplication-TileImage" content="%sveltekit.assets%/icons/ms-tile-144.png">
    <meta name="msapplication-TileColor" content="#2B4B8C">
    <meta name="viewport" content="width=device-width" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Global Governance Frameworks",
      "url": "https://globalgovernanceframeworks.org",
      "logo": "https://globalgovernanceframeworks.org/icons/logo512.png"
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <style>
      /* Set global font defaults */
      body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      }
      
      .btn-primary {
        background-color: #2563eb;
        color: white;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
        transition-property: all;
        transition-duration: 200ms;
      }
      .btn-primary:hover {
        background-color: #1d4ed8;
        transform: translateY(-2px);
      }
    </style>
    %sveltekit.head%
    <script>
      // Unregister any existing service workers
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
          for (let registration of registrations) {
            registration.unregister();
          }
        });
      }
      
      // Improved hash-based routing with safety checks
      (function() {
        const { hash, pathname, search } = window.location;
        
        if (!hash || hash.length <= 1) {
          if (sessionStorage.getItem('redirectPath')) {
            const redirectPath = sessionStorage.getItem('redirectPath');
            sessionStorage.removeItem('redirectPath');
            history.replaceState(null, null, redirectPath);
          }
          return;
        }
        
        const hashPath = hash.slice(1);
        const isLikelyRoute = hashPath.startsWith('/') || 
                             hashPath.startsWith('frameworks/') || 
                             hashPath.startsWith('blog/');
        
        const isOnHomePage = pathname === '/' || pathname === '';
        
        if (isLikelyRoute && isOnHomePage) {
          const cleanPath = hashPath.startsWith('/') ? hashPath : '/' + hashPath;
          console.log('Converting hash route:', hash, 'to:', cleanPath);
          history.replaceState(null, null, cleanPath);
        }
      })();
      
      // Prevent browser scroll restoration
      if (history.scrollRestoration) {
        history.scrollRestoration = 'manual';
      }
    </script>
  </head>
  <body data-sveltekit-preload-data="hover">
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
